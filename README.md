# 土砂移動推定

## 概要
- 土砂移動方向及び量の予測


## 処理の流れ
- 入力画像の読み込み
  - UAVのDEM（災害後）
  - 航空画像のDSM（災害前）
  - 国土地理院DEM
  - 傾斜方向データ
  - 土砂マスク画像
  - オルソ画像（災害後）
- DEMより傾斜データを抽出
  - 現在傾斜データ未使用
- 入力画像の切り抜き・解像度のリサンプリング
  - 一番大きいサイズのUAVに合わせる
  - UAVのNot NoDataの範囲に合わせる
- 土砂マスクの前処理
  - 画像反転, モルフォロジー処理, 輪郭抽出, 小領域除去, 輪郭データをcsv保存
- 領域分割
  - MeanShift法
  - ラベリングのために行う
- ラベリング
  - カラーラベリングと通常の2色ラベリングがある
  - 領域データを取得
- 土砂マスク中の領域の輪郭抽出
- 標高の正規化
  - 絶対的な標高値に変換する
- 堆積差分算出
- 傾斜方位データの正規化
  - 現在傾斜方位データ未使用
- 土砂移動推定
  - 1. 領域が隣接している
  - 2. 傾斜方向が上から下
  - 3. 侵食と堆積
  - 以上の条件を満たす領域すべてを抽出し水平移動距離・垂直移動距離を算出


## ディレクトリ構成
.
├── modules            : モジュールファイル
│    ├── driver.py     : 各処理の呼び出し
│    ├── prcess.py     : 画像処理
│    ├── tif.py        : tif画像操作
│    └── tool.py       : 共有モジュール
├── inputs/            : 入力画像
├── outputs/           : 出力画像・ファイル
├── area_data/         : 領域データ
├── app.py             : 各処理の起動ファイル
├── Makefile           : 全体の実行処理記述
├── .gitignore
└── README.md


## 動作環境
- python
- opencv
- gdal
- [pymeanshift](https://github.com/fjean/pymeanshift)
